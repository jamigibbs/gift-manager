language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "gift-manager-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: gift-manager # see README
  api_key:
    secure: "S9W7FZsJ+QI2FcdGgXwq1w0Ramima7BfckQRUGTe0mA9mYzlO6KrK50db12wUZ8GDmLL9wFxSNpjwUANz5UiiEWZPsiplf6FykZvEHKXN1F1g7OGTdznax617fIFZR1kGFj4skleZfvf2xRALlUZwrWrzyVKBSLMo3KUEQa/oYVYsV9qhDsxti+aNf0wOB9zbFkzph8/c1Iim8Wkm+r7BINSw7HpKJyuSh/0GzJefRd4Wug6K7EFJxaqY43z6OQ8uumaqa2kHEf0uaMbo29/JC5ObdVjO4MpoVoKHLEx9HD4ZB+ub+7euwMK9rA8wDmvI36QpXXFwD8EHAyaU5kSansq54TZn+GYNzIjZklJsE20xDfZv/B6YSsqfSuDtMp7a296TGPT2H5OH8e3zuxOpggxbNILPDkKWPEk2gP0pSM7qFoVGIJdGI9LMlTVHooObZ9wbobyqdjXDVs5QuNjNS6ZG+NjX/QHZf5gnKH6HUmDzO1EQTdAx7CoCKgY05CBE0j/Pfhb9gSwIdG8VfbOc2GRtpNagXCYAOkcitgjC1vAyCOnsny598itUJbcpqMzGUZom36D/Kklj9VBgl3E4uHBnhtKt+TxATE8s2YMZK/kIoqfHrah9W4m/je4KSpNxiBYw5AF/wecdG3peoyVn2Ygu52bpZXbLNavYoi23Ms=" # see README
